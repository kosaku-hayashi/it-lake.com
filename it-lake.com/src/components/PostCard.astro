---
interface Props {
  post: CollectionEntry<'posts'>;
}

import type { CollectionEntry } from 'astro:content';
import { extractDateAndSlug } from '../scripts/extractDateAndSlug.ts';
import { tagToSlug } from '../scripts/tagAndSlugConverter.ts';
import Link from './Link.astro';
import TagIcon from './TagIcon.astro';
const { post } = Astro.props as Props;
const {title, description, thumbnail, tags,updateDate} = post.data;
const { pubDate, slug } = extractDateAndSlug(post.id);
---

<article style="display: flex; gap: 1rem; padding: 1rem 0; border-bottom: 1px solid #ddd;">
    {post.data.thumbnail && (
        <img src={thumbnail} alt={title} style="width: 150px; height: 100px; object-fit: cover;" />
    )}

    <div style="flex: 1;">
        <h3 style="margin: 0 0 0.5rem 0; font-size: 1.25rem;">
            <a href={`/posts/${slug}`} style="text-decoration: none; color: inherit;">
                {title}
            </a>
        </h3>

        <p style="color: #555; margin: 0 0 0.5rem 0;">{description}</p>

        <div style="display: flex; align-items: center; font-size: 0.875rem; color: #888; gap: 0.5rem;">
            <time datetime={pubDate}>{pubDate}</time>
            {updateDate && (
                <>
                    <span>|</span>
                    <time datetime={updateDate}>Updated: {updateDate}</time>
                </>
            )}
            {tags && tags.length > 0 && (
                <>
                    <span>|</span>
                    <ul style="display:flex; flex-direction: row; list-style: none; padding: 0; margin: 0; gap:12px">
                        {tags.map(tag => (
                            <Link href={`/tags/${tagToSlug(tag)}`} class="no-underline">
                                <TagIcon width="12" height="12"></TagIcon>
                                <p style="display:inline; margin-left: -2px;">{tag}</p>
                            </Link>
                        ))}
                    </ul>
                </>
            )}
            <a href={`/posts/${slug}`} style="text-decoration: none; color: #0070f3; margin-left: auto;">Read more â†’</a>
        </div>
    </div>
</article>